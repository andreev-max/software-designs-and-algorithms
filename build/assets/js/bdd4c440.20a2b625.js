"use strict";(self.webpackChunksoftware_designs_and_algorithms=self.webpackChunksoftware_designs_and_algorithms||[]).push([[9641],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return d}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=c(a),d=r,m=h["".concat(l,".").concat(d)]||h[d]||u[d]||o;return a?n.createElement(m,i(i({ref:t},p),{},{components:a})):n.createElement(m,i({ref:t},p))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},78:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return u}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),i=["components"],s={sidebar_position:4},l="3. Structural Design Patterns",c={unversionedId:"design-patterns/structural_design_patterns",id:"design-patterns/structural_design_patterns",title:"3. Structural Design Patterns",description:"Structural patterns explain how to assemble objects and classes into larger structures while keeping these structures flexible and efficient. To achieve that, both inheritance and composition can be applied.",source:"@site/docs/5-design-patterns/structural_design_patterns.md",sourceDirName:"5-design-patterns",slug:"/design-patterns/structural_design_patterns",permalink:"/docs/design-patterns/structural_design_patterns",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"2. Creational Design Patterns",permalink:"/docs/design-patterns/creational_design_patterns"},next:{title:"4. Behavioral Design Patterns",permalink:"/docs/design-patterns/behavioral_design_patterns"}},p={},u=[{value:"3.1 Fa\xe7ade",id:"31-fa\xe7ade",level:2},{value:"3.1.1 Fa\xe7ade structure",id:"311-fa\xe7ade-structure",level:3},{value:"3.1.2 Fa\xe7ade example",id:"312-fa\xe7ade-example",level:3},{value:"3.1.3 When to apply, pros and cons",id:"313-when-to-apply-pros-and-cons",level:3},{value:"3.2 Decorator",id:"32-decorator",level:2},{value:"3.2.1 Decorator structure",id:"321-decorator-structure",level:3},{value:"3.2.2 Decorator example",id:"322-decorator-example",level:3},{value:"3.2.3 When to apply, pros and cons",id:"323-when-to-apply-pros-and-cons",level:3},{value:"3.3 Proxy",id:"33-proxy",level:2},{value:"3.3.1 Proxy structure",id:"331-proxy-structure",level:3},{value:"3.3.2 Proxy example",id:"332-proxy-example",level:3},{value:"3.3.3 When to apply, pros and cons",id:"333-when-to-apply-pros-and-cons",level:3}],h={toc:u};function d(e){var t=e.components,s=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},h,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"3-structural-design-patterns"},"3. Structural Design Patterns"),(0,o.kt)("p",null,"Structural patterns explain how to assemble objects and classes into larger structures while keeping these structures flexible and efficient. To achieve that, both inheritance and composition can be applied."),(0,o.kt)("h2",{id:"31-fa\xe7ade"},"3.1 Fa\xe7ade"),(0,o.kt)("p",null,"Facade is a structural design pattern that provides a simplified interface to a library, a framework, or any other complex set of classes."),(0,o.kt)("h3",{id:"311-fa\xe7ade-structure"},"3.1.1 Fa\xe7ade structure"),(0,o.kt)("p",null,"A facade is a class that provides a simple interface to a complex subsystem which contains lots of moving parts. A facade might provide limited functionality in comparison to working with the subsystem directly. However, it includes only those features that clients really care about."),(0,o.kt)("p",null,"For instance, an app that uploads short funny videos with cats to social media could potentially use a professional video conversion library. However, all that it really needs is a class with the single method encode(filename, format). After creating such a class and connecting it with the video conversion library, you will have your first facade."),(0,o.kt)("p",null,"When you call a shop to place a phone order, an operator is your facade to all services and departments of the shop. The operator provides you a simple voice interface to the ordering system, payment gateways, and various delivery services."),(0,o.kt)("p",null,"Figure 3.1 - Fa\xe7ade"),(0,o.kt)("img",{width:"700",src:a(5847).Z,alt:"Fa\xe7ade"}),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The Facade provides convenient access to a particular part of the subsystem's functionality. It knows where to direct the client's request and how to operate all the moving parts."),(0,o.kt)("li",{parentName:"ol"},"An Additional Facade class can be created to prevent polluting a single facade with unrelated features that might make it yet another complex structure. Additional facades can be used by both clients and other facades."),(0,o.kt)("li",{parentName:"ol"},"The Complex Subsystem consists of dozens of various objects. To make them all do something meaningful, you have to dive deep into the subsystem's implementation details, such as initializing objects in the correct order and supplying them with data in the proper format. Subsystem classes aren't aware of the facade's existence. They operate within the system and work with each other directly."),(0,o.kt)("li",{parentName:"ol"},"The Client uses the facade instead of calling the subsystem objects directly.")),(0,o.kt)("h3",{id:"312-fa\xe7ade-example"},"3.1.2 Fa\xe7ade example"),(0,o.kt)("p",null,"Here we have a ",(0,o.kt)("inlineCode",{parentName:"p"},"Computer")," class with lots of unclear methods."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Listing 3.1"',title:'"Listing','3.1"':!0},"class Computer {\n  public getElectricShock() { return 'Ouch!'; }\n  public makeSound() { return 'Beep beep!'; }\n  public showLoadingScreen() { return 'Loading..'; }\n  public bam() { return 'Ready to be used!'; }\n  public closeEverything() { return 'Zzzzzz bup'; }\n  public sooth() { return 'shhshh'; }\n}\n")),(0,o.kt)("p",null,"And a fa\xe7ade with 2 straightforward methods ",(0,o.kt)("inlineCode",{parentName:"p"},"turnOn")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"turnOff"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Listing 3.2"',title:'"Listing','3.2"':!0},"class ComputerFacade {\n  constructor(protected computer: Computer) {\n  }\n\n  public turnOn() {\n    this.computer.getElectricShock();\n    this.computer.makeSound();\n    this.computer.showLoadingScreen();\n    this.computer.bam();\n  }\n\n  public turnOff() {\n    this.computer.closeEverything();\n    this.computer.sooth();\n  }\n}\n\nconst computer = new ComputerFacade(new Computer());\n\ncomputer.turnOn();\ncomputer.turnOff();\n")),(0,o.kt)("h3",{id:"313-when-to-apply-pros-and-cons"},"3.1.3 When to apply, pros and cons"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"when need a limited but straightforward interface to a complex subsystem"),(0,o.kt)("li",{parentName:"ul"},"to structure a subsystem into layers: create facades to define entry points to each level of a subsystem. You can reduce coupling between multiple subsystems by requiring them to communicate only through facades")),(0,o.kt)("p",null,"Pros"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"you can isolate your code from the complexity of a subsystem")),(0,o.kt)("p",null,"Cons"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"a facade can become a god object coupled to all classes of an app")),(0,o.kt)("h2",{id:"32-decorator"},"3.2 Decorator"),(0,o.kt)("p",null,"Decorator is a structural design pattern that lets you attach new behaviors to objects by placing these objects inside special wrapper objects that contain the behaviors."),(0,o.kt)("h3",{id:"321-decorator-structure"},"3.2.1 Decorator structure"),(0,o.kt)("p",null,"Imagine you are developing a coffee brewing system. Initially only black coffee brewing is required. Then single black coffee option become not enough. Now you need to implement white coffee and black with cream. Therefore, you reasonably made a ",(0,o.kt)("inlineCode",{parentName:"p"},"Coffee")," abstract class and implemented it in black, white and black with cream classes. Soon you got request for a white coffee with cream and for coffees with different amount of sugar. Thus, you came to the point, that inheritance is not the case."),(0,o.kt)("p",null,"Extending a class is the first thing that comes to mind when you need to alter an object's behavior. However, inheritance has several serious caveats that you need to be aware of: it is static, and it does not let a class inherit behaviors of multiple classes at the same time."),(0,o.kt)("p",null,"So, apparently, we need a composition here."),(0,o.kt)("p",null,'"Wrapper" is the alternative nickname for the Decorator pattern that clearly expresses the main idea of the pattern. A ',(0,o.kt)("em",{parentName:"p"},"wrapper")," is an object that can be linked with some target object. The wrapper contains the same set of methods as the target and delegates to it all requests it receives. However, the wrapper may alter the result by doing something either before or after it passes the request to the target."),(0,o.kt)("p",null,"When does a simple wrapper become the real decorator? As I mentioned, the wrapper implements the same interface as the wrapped object. That's why from the client's perspective these objects are identical. Make the wrapper's reference field accept any object that follows that interface. This will allow you to cover an object in multiple wrappers, adding the combined behavior of all the wrappers to it."),(0,o.kt)("p",null,"Figure 3.2 - Decorator"),(0,o.kt)("img",{width:"700",src:a(3492).Z,alt:"Decorator"}),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Component")," declares the common interface for both wrappers and wrapped objects."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"Concrete Component")," is a class of objects being wrapped. It defines the basic behaviour, which can be altered by decorators."),(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Base Decorator")," class has a field for referencing a wrapped object. The field's type should be declared as the component interface, so it can contain both concrete components and decorators. The base decorator delegates all operations to the wrapped object."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"Concrete Decorators")," define extra behaviours that can be added to components dynamically. Concrete decorators override methods of the base decorator and execute their behaviour either before or after calling the parent method."),(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Client")," can wrap components in multiple layers of decorators, as long as it works with all objects via the component interface.")),(0,o.kt)("h3",{id:"322-decorator-example"},"3.2.2 Decorator example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Listing 3.3"',title:'"Listing','3.3"':!0},"interface Coffee {\n    getCost();\n    getDescription();\n}\n\nclass SimpleCoffee implements Coffee {\n    public getCost() { return 10; }\n    public getDescription() { return 'Simple coffee' }\n}\n\nclass CoffeeDecorator implements Coffee {\n  protected wrappee: Coffee;\n\n  constructor(coffee: Coffee) {\n    this.wrappee = coffee;\n  }\n\n  public getCost() { return this.wrappee.getCost(); }\n  public getDescription() { return this.wrappee.getDescription(); }\n}\n")),(0,o.kt)("p",null,"The decorators and the data source class implement the same interface, which makes them all interchangeable in the client code."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Listing 3.4"',title:'"Listing','3.4"':!0},"class MilkCoffeeDecorator extends CoffeeDecorator {\n  public getCost(): number {\n    return this.wrappee.getCost() + 2;\n  }\n\n  public getDescription(): string {\n    return this.wrappee.getDescription() + 'with milk';\n  }\n}\n\nclass WhipCoffeeDecorator extends CoffeeDecorator {\n  public getCost(): number {\n    return this.wrappee.getCost() + 3;\n  }\n\n  public getDescription(): string {\n    return this.wrappee.getDescription() + 'and with whip';\n  }\n}\n\nlet someCoffee = new SimpleCoffee();\n\nsomeCoffee.getCost(); // 10\nsomeCoffee.getDescription(); // Simple Coffee\nsomeCoffee = new MilkCoffeeDecorator(someCoffee);\nsomeCoffee.getCost(); // 12\nsomeCoffee = new WhipCoffeeDecorator(someCoffee);\nsomeCoffee.getDescription(); // Simple Coffee with milk and whip\n")),(0,o.kt)("h3",{id:"323-when-to-apply-pros-and-cons"},"3.2.3 When to apply, pros and cons"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"when you need to be able to assign extra behaviours to objects at runtime without breaking the code that uses these objects \u2013 The Decorator lets you structure your business logic into layers, create a decorator for each layer and compose objects with various combinations of this logic at runtime. The client code can treat all these objects in the same way, since they all follow a common interface"),(0,o.kt)("li",{parentName:"ul"},"when it's awkward or not possible to extend an object's behaviour using inheritance. For example, you are working with a library, and you don't have access to alter its behavior, but what you can do is extending it with Decorator")),(0,o.kt)("p",null,"Pros"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"extending an object's behavior without making a new subclass"),(0,o.kt)("li",{parentName:"ul"},"adding or remove responsibilities from an object at runtime"),(0,o.kt)("li",{parentName:"ul"},"combining several behaviors by wrapping an object into multiple decorators"),(0,o.kt)("li",{parentName:"ul"},"dividing a monolithic class that implements many possible variants of behavior into several smaller classes")),(0,o.kt)("p",null,"Cons"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"hard to remove a specific wrapper from the wrappers stack"),(0,o.kt)("li",{parentName:"ul"},"hard to implement a decorator in such a way that its behavior doesn't depend on the order in the decorators stack"),(0,o.kt)("li",{parentName:"ul"},"initial configuration code of layers might look overcomplicated")),(0,o.kt)("h2",{id:"33-proxy"},"3.3 Proxy"),(0,o.kt)("p",null,"Proxy is a structural design pattern that lets you provide a substitute or placeholder for another object. A proxy controls access to the original object, allowing you to perform something either before or after the request gets through to the original object."),(0,o.kt)("p",null,"In other words by using proxy, one class provides functionality of another class.\nUnlike Decorator, a Proxy usually manages the life cycle of its service object on its own."),(0,o.kt)("h3",{id:"331-proxy-structure"},"3.3.1 Proxy structure"),(0,o.kt)("p",null,"Figure 3.3 - Proxy"),(0,o.kt)("img",{width:"700",src:a(684).Z,alt:"Proxy"}),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"ServiceInterface")," declares the interface of the ",(0,o.kt)("inlineCode",{parentName:"li"},"Service"),". The proxy must follow this interface to be able to disguise itself as a service object."),(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Service")," is a class that provides some useful business logic."),(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Proxy")," class has a reference field that points to a service object. After the proxy finishes its processing (e.g., lazy initialization, logging, access control, caching, etc.), it passes the request to the service object."),(0,o.kt)("li",{parentName:"ol"},"Usually, proxies manage the full lifecycle of their service objects."),(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Client")," should work with both services and proxies via the same interface. This way you can pass a proxy into any code that expects a service object.")),(0,o.kt)("h3",{id:"332-proxy-example"},"3.3.2 Proxy example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Listing 3.5"',title:'"Listing','3.5"':!0},"// Presume we have an input filed with an ID of inputname:\nconst el = `<input type=\"text\" id=\"inputname\" value=\"\" />`;\n\n// We also have a JS object named myUser with\n// an id property which references this input\nconst myUser = {\n  id: 'inputname',\n  name: ''\n};\n\n// Our first objective is to update myUser.name\n// when a user changes the input value. This can be achieved\n// with an onchange event handler on the field:\n(function inputChange(myObject) {\n  if (!myObject || !myObject.id) return;\n\n  const input = document.getElementById(myObject.id);\n\n  input.addEventListener('onchange', function (e) {\n    myObject.name = input.value;\n  });\n})(myUser);\n")),(0,o.kt)("p",null,"There is a JavaScript native class ",(0,o.kt)("inlineCode",{parentName:"p"},"Proxy"),", which allows catching get/set calls of objects and perform additional actions. Here we use this feature to create a primitive but operating bi-directional data-binding."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Listing 3.6"',title:'"Listing','3.6"':!0},"// create proxy\nconst myUserProxy = new Proxy(myUser, {\n  set: function(target, prop, newValue) {\n    if (prop === 'name' && target.id) {\n      // update object property\n      target[prop] = newValue;\n\n      // update input field value\n      document.getElementById(target.id).value = newValue;\n\n      return true;\n    }\n\n    return false;\n  }\n});\n\n// set a new name\nmyUserProxy.name = 'Craig';\n\nconsole.log(myUserProxy.name); // Craig\nconsole.log(document.getElementById('inputname').value);\n")),(0,o.kt)("h3",{id:"333-when-to-apply-pros-and-cons"},"3.3.3 When to apply, pros and cons"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"lazy initialization (virtual proxy) of a heavyweight service object that wastes system resources by being always up, but is needed from time to time. Instead of creating the object when the app launches, you can delay the object's initialization to a time when it's really needed"),(0,o.kt)("li",{parentName:"ul"},"access control (protection proxy) \u2013 for letting only specific clients to be able to use the service object; for instance, when your objects are crucial parts of an operating system and clients are various launched applications (including malicious ones). The proxy can pass the request to the service object only if the client's credentials match some criteria"),(0,o.kt)("li",{parentName:"ul"},"local execution of a remote service (remote proxy). This is when the service object is located on a remote server. In this case, the proxy passes the client request over the network, handling all the nasty details of working with the network"),(0,o.kt)("li",{parentName:"ul"},"logging requests (logging proxy). This is when you want to keep a history of requests to the service object. The proxy can log each request before passing it to the service"),(0,o.kt)("li",{parentName:"ul"},"caching request results (caching proxy). This is when you need to cache results of client requests and manage the life cycle of this cache, especially if results are quite large. The proxy can implement caching for recurring requests that always yield the same results. The proxy may use the parameters of requests as the cache keys")),(0,o.kt)("p",null,"Pros"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"controlling the service object without clients knowing about it"),(0,o.kt)("li",{parentName:"ul"},"managing the lifecycle of the service object when clients don't care about it"),(0,o.kt)("li",{parentName:"ul"},"the proxy works even if the service object isn't ready or is not available"),(0,o.kt)("li",{parentName:"ul"},"introducing new proxies without changing the service or clients")),(0,o.kt)("p",null,"Cons"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"overcomplicated code since you need to introduce a lot of new classes"),(0,o.kt)("li",{parentName:"ul"},"the response from the service might get delayed")))}d.isMDXComponent=!0},3492:function(e,t,a){t.Z=a.p+"assets/images/decorator-52f58839abac80918f3f9530470bbf89.jpg"},5847:function(e,t,a){t.Z=a.p+"assets/images/facade-a31f84f01a46d690e8da800a2f5fa762.jpg"},684:function(e,t,a){t.Z=a.p+"assets/images/proxy-25e10ab8017d5f98e53aa00dc0e46222.jpg"}}]);